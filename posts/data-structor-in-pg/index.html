<!doctype html><html lang=zh-cn><head><title>Data Structures in PG · MyNotes</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="yyc"><meta name=description content=" 1 Hash & TapeSet 2 Slot & tuple 1 Hash & TapeSet 链接到标题 class LogicalTapeSet { + BufFile pfile + SharedFileSet fileset + int worker + long nBlocksAllocated + long nBlocksWritten + long nHoleBlocks + bool forgetFreeSpace + long freeBlocks + long nFreeBlocks + Size freeBlocksLen + bool enable_prealloc } class LogicalTape { + LogicalTapeSet tapeSet + bool writing + bool frozen + bool dirty + long firstBlockNumber + long curBlockNumber + long nextBlockNumber + long offsetBlockNumber + char buffer + int buffer_size + int max_size + int pos + int nbytes + long prealloc + int nprealloc + int prealloc_size } class BufFile { + int numFiles + File files + bool isInterXact + bool dirty + bool readOnly + FileSet fileset + const name + ResourceOwner resowner + int curFile + off_t curOffset + int pos + int nbytes + PGAlignedBlock buffer } LogicalTapeSet *-- BufFile class HashAggSpill { + int npartitions + LogicalTape partitions + int64 ntuples + uint32 mask + int shift + hyperLogLogState hll_card } HashAggSpill *-- LogicalTape LogicalTape - LogicalTapeSet 2 Slot & tuple 链接到标题 class TupleTableSlot { + NodeTag type + int tts_flags + AttrNumber tts_nvalid + const tts_ops + TupleDesc tts_tupleDescriptor + int tts_values + int tts_isnull + int tts_mcxt + ItemPointerData tts_tid + int tts_tableOid } class MinimalTupleData { + int t_len + char mt_padding + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class HeapTupleHeaderData { + union t_choice + ItemPointerData t_ctid + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class union { + HeapTupleFields t_heap + DatumTupleFields t_datum } HeapTupleHeaderData *-- union class MinimalTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + MinimalTuple mintuple + HeapTupleData minhdr + int off } class HeapTupleData { + int t_len + ItemPointerData t_self + int t_tableOid + HeapTupleHeader t_data } class VirtualTupleTableSlot { + TupleTableSlot base + char data } class HeapTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + int off + HeapTupleData tupdata } class BufferHeapTupleTableSlot { + HeapTupleTableSlot base + Buffer buffer } TupleTableSlot <|-- MinimalTupleTableSlot TupleTableSlot <|-- VirtualTupleTableSlot TupleTableSlot <|-- HeapTupleTableSlot HeapTupleTableSlot <|-- BufferHeapTupleTableSlot MinimalTupleTableSlot *-- MinimalTupleData HeapTupleTableSlot *-- HeapTupleData HeapTupleData *-- HeapTupleHeaderData "><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Data Structures in PG"><meta name=twitter:description content=" 1 Hash & TapeSet 2 Slot & tuple 1 Hash & TapeSet 链接到标题 class LogicalTapeSet { + BufFile pfile + SharedFileSet fileset + int worker + long nBlocksAllocated + long nBlocksWritten + long nHoleBlocks + bool forgetFreeSpace + long freeBlocks + long nFreeBlocks + Size freeBlocksLen + bool enable_prealloc } class LogicalTape { + LogicalTapeSet tapeSet + bool writing + bool frozen + bool dirty + long firstBlockNumber + long curBlockNumber + long nextBlockNumber + long offsetBlockNumber + char buffer + int buffer_size + int max_size + int pos + int nbytes + long prealloc + int nprealloc + int prealloc_size } class BufFile { + int numFiles + File files + bool isInterXact + bool dirty + bool readOnly + FileSet fileset + const name + ResourceOwner resowner + int curFile + off_t curOffset + int pos + int nbytes + PGAlignedBlock buffer } LogicalTapeSet *-- BufFile class HashAggSpill { + int npartitions + LogicalTape partitions + int64 ntuples + uint32 mask + int shift + hyperLogLogState hll_card } HashAggSpill *-- LogicalTape LogicalTape - LogicalTapeSet 2 Slot & tuple 链接到标题 class TupleTableSlot { + NodeTag type + int tts_flags + AttrNumber tts_nvalid + const tts_ops + TupleDesc tts_tupleDescriptor + int tts_values + int tts_isnull + int tts_mcxt + ItemPointerData tts_tid + int tts_tableOid } class MinimalTupleData { + int t_len + char mt_padding + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class HeapTupleHeaderData { + union t_choice + ItemPointerData t_ctid + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class union { + HeapTupleFields t_heap + DatumTupleFields t_datum } HeapTupleHeaderData *-- union class MinimalTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + MinimalTuple mintuple + HeapTupleData minhdr + int off } class HeapTupleData { + int t_len + ItemPointerData t_self + int t_tableOid + HeapTupleHeader t_data } class VirtualTupleTableSlot { + TupleTableSlot base + char data } class HeapTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + int off + HeapTupleData tupdata } class BufferHeapTupleTableSlot { + HeapTupleTableSlot base + Buffer buffer } TupleTableSlot <|-- MinimalTupleTableSlot TupleTableSlot <|-- VirtualTupleTableSlot TupleTableSlot <|-- HeapTupleTableSlot HeapTupleTableSlot <|-- BufferHeapTupleTableSlot MinimalTupleTableSlot *-- MinimalTupleData HeapTupleTableSlot *-- HeapTupleData HeapTupleData *-- HeapTupleHeaderData "><meta property="og:title" content="Data Structures in PG"><meta property="og:description" content=" 1 Hash & TapeSet 2 Slot & tuple 1 Hash & TapeSet 链接到标题 class LogicalTapeSet { + BufFile pfile + SharedFileSet fileset + int worker + long nBlocksAllocated + long nBlocksWritten + long nHoleBlocks + bool forgetFreeSpace + long freeBlocks + long nFreeBlocks + Size freeBlocksLen + bool enable_prealloc } class LogicalTape { + LogicalTapeSet tapeSet + bool writing + bool frozen + bool dirty + long firstBlockNumber + long curBlockNumber + long nextBlockNumber + long offsetBlockNumber + char buffer + int buffer_size + int max_size + int pos + int nbytes + long prealloc + int nprealloc + int prealloc_size } class BufFile { + int numFiles + File files + bool isInterXact + bool dirty + bool readOnly + FileSet fileset + const name + ResourceOwner resowner + int curFile + off_t curOffset + int pos + int nbytes + PGAlignedBlock buffer } LogicalTapeSet *-- BufFile class HashAggSpill { + int npartitions + LogicalTape partitions + int64 ntuples + uint32 mask + int shift + hyperLogLogState hll_card } HashAggSpill *-- LogicalTape LogicalTape - LogicalTapeSet 2 Slot & tuple 链接到标题 class TupleTableSlot { + NodeTag type + int tts_flags + AttrNumber tts_nvalid + const tts_ops + TupleDesc tts_tupleDescriptor + int tts_values + int tts_isnull + int tts_mcxt + ItemPointerData tts_tid + int tts_tableOid } class MinimalTupleData { + int t_len + char mt_padding + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class HeapTupleHeaderData { + union t_choice + ItemPointerData t_ctid + int t_infomask2 + int t_infomask + int t_hoff + int t_bits } class union { + HeapTupleFields t_heap + DatumTupleFields t_datum } HeapTupleHeaderData *-- union class MinimalTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + MinimalTuple mintuple + HeapTupleData minhdr + int off } class HeapTupleData { + int t_len + ItemPointerData t_self + int t_tableOid + HeapTupleHeader t_data } class VirtualTupleTableSlot { + TupleTableSlot base + char data } class HeapTupleTableSlot { + TupleTableSlot base + HeapTuple tuple + int off + HeapTupleData tupdata } class BufferHeapTupleTableSlot { + HeapTupleTableSlot base + Buffer buffer } TupleTableSlot <|-- MinimalTupleTableSlot TupleTableSlot <|-- VirtualTupleTableSlot TupleTableSlot <|-- HeapTupleTableSlot HeapTupleTableSlot <|-- BufferHeapTupleTableSlot MinimalTupleTableSlot *-- MinimalTupleData HeapTupleTableSlot *-- HeapTupleData HeapTupleData *-- HeapTupleHeaderData "><meta property="og:type" content="article"><meta property="og:url" content="https://yangyingchao.github.io/posts/data-structor-in-pg/"><meta property="article:section" content="posts"><link rel=canonical href=https://yangyingchao.github.io/posts/data-structor-in-pg/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.135e22c97ff685fe983fc60048e309ced8f00d8d38f536aa67dba8a13a03dfa4.css integrity="sha256-E14iyX/2hf6YP8YASOMJztjwDY049TaqZ9uooToD36Q=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>MyNotes</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://yangyingchao.github.io/posts/data-structor-in-pg/>Data Structures in PG</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=0001-01-01T00:00:00Z>January 1, 0001</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
阅读时间：2 分钟</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/tag1/>tag1</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tag2/>tag2</a></span></div></div></header><div class=post-content><ul><li>1 <a href=#h:cc825ae9-05f0-4ce8-a53c-a0697f0c1d99>Hash & TapeSet</a></li><li>2 <a href=#h:c2c5a9a7-a0ef-4fd8-b7ec-46ada6e71726>Slot & tuple</a></li></ul><h2 id=h:cc825ae9-05f0-4ce8-a53c-a0697f0c1d99>1 Hash & TapeSet
<a class=heading-link href=#h:cc825ae9-05f0-4ce8-a53c-a0697f0c1d99><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h2><pre tabindex=0><code class=language-plantuml data-lang=plantuml>
class LogicalTapeSet {
    + BufFile pfile
    + SharedFileSet fileset
    + int worker
    + long nBlocksAllocated
    + long nBlocksWritten
    + long nHoleBlocks
    + bool forgetFreeSpace
    + long freeBlocks
    + long nFreeBlocks
    + Size freeBlocksLen
    + bool enable_prealloc
}

class LogicalTape {
    + LogicalTapeSet tapeSet
    + bool writing
    + bool frozen
    + bool dirty
    + long firstBlockNumber
    + long curBlockNumber
    + long nextBlockNumber
    + long offsetBlockNumber
    + char buffer
    + int buffer_size
    + int max_size
    + int pos
    + int nbytes
    + long prealloc
    + int nprealloc
    + int prealloc_size
}



class BufFile {
    + int numFiles
    + File files
    + bool isInterXact
    + bool dirty
    + bool readOnly
    + FileSet fileset
    + const name
    + ResourceOwner resowner
    + int curFile
    + off_t curOffset
    + int pos
    + int nbytes
    + PGAlignedBlock buffer
}

LogicalTapeSet *-- BufFile

class HashAggSpill {
+ int npartitions
+ LogicalTape partitions
+ int64 ntuples
+ uint32 mask
+ int shift
+ hyperLogLogState hll_card
}


HashAggSpill *-- LogicalTape

LogicalTape - LogicalTapeSet
</code></pre><h2 id=h:c2c5a9a7-a0ef-4fd8-b7ec-46ada6e71726>2 Slot & tuple
<a class=heading-link href=#h:c2c5a9a7-a0ef-4fd8-b7ec-46ada6e71726><i class="fa fa-link" aria-hidden=true title=链接到标题></i>
<span class=sr-only>链接到标题</span></a></h2><pre tabindex=0><code class=language-plantuml data-lang=plantuml>
class TupleTableSlot {
  + NodeTag type
  + int tts_flags
  + AttrNumber tts_nvalid
  + const tts_ops
  + TupleDesc tts_tupleDescriptor
  + int tts_values
  + int tts_isnull
  + int tts_mcxt
  + ItemPointerData tts_tid
  + int tts_tableOid
}




class MinimalTupleData {
  + int t_len
  + char mt_padding
  + int t_infomask2
  + int t_infomask
  + int t_hoff
  + int t_bits
}


class HeapTupleHeaderData {
  + union t_choice
  + ItemPointerData t_ctid
  + int t_infomask2
  + int t_infomask
  + int t_hoff
  + int t_bits
}

class union {
  + HeapTupleFields t_heap
  + DatumTupleFields t_datum
}


HeapTupleHeaderData *-- union

class MinimalTupleTableSlot {
  + TupleTableSlot base
  + HeapTuple tuple
  + MinimalTuple mintuple
  + HeapTupleData minhdr
  + int off
}

class HeapTupleData {
  + int t_len
  + ItemPointerData t_self
  + int t_tableOid
  + HeapTupleHeader t_data
}


class VirtualTupleTableSlot {
  + TupleTableSlot base
  + char data
}

class HeapTupleTableSlot {
  + TupleTableSlot base
  + HeapTuple tuple
  + int off
  + HeapTupleData tupdata
}

class BufferHeapTupleTableSlot {
  + HeapTupleTableSlot base
  + Buffer buffer
}


TupleTableSlot &lt;|-- MinimalTupleTableSlot
TupleTableSlot &lt;|-- VirtualTupleTableSlot
TupleTableSlot &lt;|-- HeapTupleTableSlot
HeapTupleTableSlot &lt;|-- BufferHeapTupleTableSlot


MinimalTupleTableSlot *-- MinimalTupleData
HeapTupleTableSlot *-- HeapTupleData
HeapTupleData *-- HeapTupleHeaderData
</code></pre></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2023
yyc
·
技术支持 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>