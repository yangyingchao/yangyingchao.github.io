<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ | MyNotes</title><meta name=keywords content="hugo,blog"><meta name=description content="1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.2 å†™åšå®¢ 1.3 éƒ¨ç½²ç¯‡ 1.4 é‡åˆ°çš„é—®é¢˜ 2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown 2.1 ç—›ç‚¹ 2.2 å¦‚ä½•è§£å†³ 2.3 å­˜åœ¨çš„é—®é¢˜"><meta name=author content="Yang, Ying-chao"><link rel=canonical href=https://yangyingchao.github.io/posts/how-this-blog-is-generated/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://yangyingchao.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yangyingchao.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yangyingchao.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://yangyingchao.github.io/apple-touch-icon.png><link rel=mask-icon href=https://yangyingchao.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ"><meta property="og:description" content="1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.2 å†™åšå®¢ 1.3 éƒ¨ç½²ç¯‡ 1.4 é‡åˆ°çš„é—®é¢˜ 2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown 2.1 ç—›ç‚¹ 2.2 å¦‚ä½•è§£å†³ 2.3 å­˜åœ¨çš„é—®é¢˜"><meta property="og:type" content="article"><meta property="og:url" content="https://yangyingchao.github.io/posts/how-this-blog-is-generated/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-05T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ"><meta name=twitter:description content="1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.2 å†™åšå®¢ 1.3 éƒ¨ç½²ç¯‡ 1.4 é‡åˆ°çš„é—®é¢˜ 2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown 2.1 ç—›ç‚¹ 2.2 å¦‚ä½•è§£å†³ 2.3 å­˜åœ¨çš„é—®é¢˜"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://yangyingchao.github.io/posts/"},{"@type":"ListItem","position":3,"name":"è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ","item":"https://yangyingchao.github.io/posts/how-this-blog-is-generated/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ","name":"è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ","description":"1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.2 å†™åšå®¢ 1.3 éƒ¨ç½²ç¯‡ 1.4 é‡åˆ°çš„é—®é¢˜ 2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown 2.1 ç—›ç‚¹ 2.2 å¦‚ä½•è§£å†³ 2.3 å­˜åœ¨çš„é—®é¢˜","keywords":["hugo","blog"],"articleBody":" 1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.2 å†™åšå®¢ 1.3 éƒ¨ç½²ç¯‡ 1.4 é‡åˆ°çš„é—®é¢˜ 2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown 2.1 ç—›ç‚¹ 2.2 å¦‚ä½•è§£å†³ 2.3 å­˜åœ¨çš„é—®é¢˜ 2.4 é‡åˆ°çš„é—®é¢˜ 3 é™„å½• 3.1 æˆ‘æ­£åœ¨ç”¨çš„ github actions 3.2 å½“å‰ç”¨çš„è„šæœ¬ å‚è€ƒè¿™é‡Œï¼š\nhttps://superbear.github.io/post/2021/11/use-org-mode-and-hugo-to-write-blog/ https://superbear.github.io/post/2021/12/batch-export-org-files-to-markdown-with-emacs-script-and-ox-hugo/ æ¬è¿ä¸€ä¸‹ï¼Œæ”¾ä¸¢ã€‚ã€‚ã€‚\nä»¥ä¸‹å†…å®¹è½¬è‡ª superbear çš„åšå®¢ã€‚\n1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages 1.1 å‡†å¤‡å·¥ä½œ 1.1.1 åˆ›å»ºä¸¤ä¸ª Github ä»“åº“ ç”¨æ¥æ”¾ org æ–‡ä»¶. markdown æ–‡ä»¶åŠ Hugo ç›¸å…³é…ç½®ï¼Œå¯ä»¥è®¾ç½®æˆç§æœ‰ï¼Œå¦‚ blogã€‚ Github Pages ä»“åº“ï¼Œç”¨æ¥æ”¾ç”Ÿæˆçš„é™æ€æ–‡ä»¶ã€‚ä¸€èˆ¬æ˜¯{username}.github.ioã€‚ 1.1.2 å®‰è£… Hugo a static site generator written in Go 1.1.3 å®‰è£… ox-hugo å°† org æ–‡ä»¶ç¿»è¯‘æˆ markdown æ–‡ä»¶ï¼Œwritten in Emacs Lispã€‚Hugo æ”¯æŒ Org Modeï¼Œä½†æ®è¯´æ”¯æŒå¾—ä¸æ˜¯å¾ˆå¥½ 1ã€‚ æ¯•ç«Ÿ Emacs Lisp å¤„ç† org æ–‡ä»¶ç›¸å…³çš„åŒ…æ¯” Go å¤šï¼Œå°±ç›´æ¥ç”¨ ox-hugo è½¬ markdown çš„æ–¹æ¡ˆäº†ã€‚ ä¸æ˜¯ Emacs ç”¨æˆ·ï¼Ÿ\nå¯è·³è¿‡ Org Mode ç›¸å…³å†…å®¹ 1.1.4 é…ç½®ç¯å¢ƒ å„è½¯ä»¶ç‰ˆæœ¬\nEmacs 27.1\nOrg Mode 9.3\nox-hugo 20210916.1332\nHugo v0.89.4\né…ç½® Hugo\n# åœ¨ blog ä»“åº“ä¸­æ–°å»º hugo site cd /path/to/blog \u0026\u0026 hugo new site hugo # é€‰ä¸ªä¸»é¢˜ï¼Œå¹¶è®¾ç½®æˆå­æ¨¡å—ï¼ˆåç»­å‡çº§/æ›¿æ¢éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼‰ git submodule add https://github.com/olOwOlo/hugo-theme-even.git hugo/themes/even # ä¿®æ”¹é»˜è®¤é…ç½® å¼€å¯æœ¬åœ°å®æ—¶é¢„è§ˆ\n# é…ç½®ä¿®æ”¹. markdown æ–‡ä»¶æ”¹åŠ¨éƒ½ä¼šè¢«ç›‘æ§åˆ° cd blog \u0026\u0026 hugo â€“source hugo server -D é…ç½® ox-hugo\n;;; åœ¨ init.el é‡Œæˆ–å…¶ä»–æ–‡ä»¶é‡ŒåŠ ä»¥ä¸‹ä»£ç  (with-eval-after-load 'ox (require 'ox-hugo)) ;;; å¯é€‰ã€‚å…¨å±€é…ç½®ï¼Œå¦‚å¯¼å‡ºç›®å½•ç­‰å­—æ®µï¼Œä¹Ÿå¯ä»¥åœ¨ org æ–‡ä»¶é‡Œè¿›è¡Œé…ç½® ;;; M-x customize-variable org-hugo 1.2 å†™åšå®¢ æ–°å»º org ç›®å½•åŠæ–‡ä»¶\ncd blog \u0026\u0026 mkdir -p org/2021/11 # å¯é€‰ï¼Œå¯ä»¥ä¸æŒ‰å¹´æœˆæ—¥åˆ†æ‹†åˆ†ç›®å½•ã€‚æ‹†åˆ†åæ–¹ä¾¿ç®¡ç†ï¼Œä½†å¦‚æœç”¨æˆ·ç›´æ¥è®¿é—®æŸå¹´çš„æ•°æ®ï¼Œé¡µé¢å°±ä¼š 404 æ–°å»º org æ–‡ä»¶ï¼Œå¦‚ test.org\n#+OPTIONS: author:nil ^:{} # å‘Šè¯‰ ox-hugo å°†å¯¼å‡ºçš„ markdown æ–‡ä»¶æ”¾åˆ°å“ªé‡Œã€‚æ³¨æ„ï¼ševen ä¸»é¢˜éœ€è¦å‘å¸ƒåˆ° post ç›®å½•ã€‚ # see: https://ox-hugo.scripter.co/#before-you-export #+HUGO_BASE_DIR: ../../../hugo #+HUGO_SECTION: post/2021/11 #+HUGO_CUSTOM_FRONT_MATTER: :toc true #+HUGO_AUTO_SET_LASTMOD: t #+HUGO_DRAFT: false #+DATE: [2021-11-28 Sun 19:28] #+TITLE: æ ‡é¢˜ #+HUGO_TAGS: tag1 tag2 #+HUGO_CATEGORIES: category1 category2 Helloï¼ŒWorld å¯¼å‡º org åˆ° markdown æ–‡ä»¶\nåœ¨ Emacs é‡Œæ‰§è¡Œ C-c C-e H hï¼ˆFile to Md fileï¼‰å¯¼å‡ºæ•´ä¸ª org æ–‡ä»¶åˆ° markdown æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å¯¼å‡º subtreeï¼Œ å…·ä½“çœ‹ä¸ªäººå–œå¥½\nè®¿é—®http://127.0.0.1:1313/\næ­£å¸¸æƒ…å†µå°±ä¼šçœ‹åˆ°åšå®¢ç•Œé¢å•¦\næäº¤ org åŠ markdown æ–‡ä»¶åˆ° blog ä»“åº“\nä½¿ç”¨ Yasnippetï¼ˆæ¨èï¼‰ ä¸‹æ¬¡æ–°å»ºæ–‡ä»¶å°±ä¸ç”¨ copy ä¸€äº›å…ƒæ•°æ®\n# -*- mode: snippet -*- # name: hugo # key: hugo # -- #+OPTIONS: author:nil ^:{} #+HUGO_BASE_DIR: ../../../hugo #+HUGO_SECTION: post/`(format-time-string \"%Y/%m\")` #+HUGO_CUSTOM_FRONT_MATTER: :toc true #+HUGO_AUTO_SET_LASTMOD: t #+HUGO_DRAFT: false #+DATE: `(format-time-string \"[%Y-%m-%d %a %H:%M]\")` #+TITLE: $1 #+HUGO_TAGS: $2 #+HUGO_CATEGORIES: $3 $0 1.2.1 ç›®å½•ç»“æ„ . â”œâ”€â”€ .github â”‚ â””â”€â”€ workflows â”œâ”€â”€ hugo â”‚ â”œâ”€â”€ archetypes â”‚ â”œâ”€â”€ content â”‚ â”‚ â””â”€â”€ post â”‚ â”œâ”€â”€ data â”‚ â”œâ”€â”€ layouts â”‚ â”‚ â””â”€â”€ _internal â”‚ â”œâ”€â”€ static â”‚ â””â”€â”€ themes â”‚ â””â”€â”€ even â”œâ”€â”€ org â”‚ â””â”€â”€ 2021 â”‚ â””â”€â”€ 11 â””â”€â”€ scripts 1.3 éƒ¨ç½²ç¯‡ 1.3.1 é…ç½® Github Action åœ¨ blog ä»“åº“ä¸‹æ–°å¢.github/workflows/main.yml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nname: GitHub Pages on: push: branches: - main # Set a branch to deploy pull_request: jobs: deploy: runs-on: ubuntu-20.04 concurrency: group: ${{ github.workflow }}-${{ github.ref }} steps: # ä¿®æ”¹æ—¶åŒº - name: Set Timezone run: sudo timedatectl set-timezone 'Asia/Shanghai' - uses: actions/checkout@v2 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: # å»ºè®®å’Œæœ¬åœ°ç”¨çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼Œä»è€Œè·å¾—ä¸€è‡´çš„ä½“éªŒ hugo-version: '0.89.4' # extended: true - name: Build run: | hugo --source hugo --minify --buildFuture --buildExpired - name: Deploy uses: peaceiris/actions-gh-pages@v3 if: ${{ github.ref == 'refs/heads/main' }} with: # github_token: ${{ secrets.PERSONAL_ACCESS_TOKEN }} # publish_branch: gh-pages # publish_dir: hugo/public deploy_key: ${{ secrets.DEPLOY_KEY }} external_repository: superbear/superbear.github.io # é»˜è®¤æ˜¯ master ç›®å½•ï¼Œgithub ä¸Šå¯ä¿®æ”¹ publish_branch: master publish_dir: hugo/public 1.3.2 é…ç½® DEPLOY_KEY ç”Ÿæˆ github deploy-keys\nå°†å…¬é’¥æ·»åŠ è‡³{username}.github.io ä»“çš„ Deploy keysï¼ˆSettings -\u003e Deploy keysï¼‰ä¸­ï¼› å°†ç§é’¥æ·»åŠ è‡³ blog ä»“åº“çš„ secretsï¼ˆSettings -\u003e Secretsï¼‰ä¸­ï¼› å°†æœ¬åœ° blog ç›®å½•çš„æ”¹åŠ¨ push åˆ°è¿œç¨‹ blog ä»“åº“ master åˆ†æ”¯ï¼› æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€æ®µæ—¶é—´ä¹‹åï¼Œå¯ä»¥åœ¨{username}.github.io çš„ master åˆ†æ”¯ä¸‹çœ‹åˆ° hugo ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼› æ²¡æœ‰çš„è¯ï¼Œå¯ä»¥æ ¹æ® blog ä»“åº“çš„ Github Actions æ—¥å¿—æ’æŸ¥ä¸‹ã€‚ 1.4 é‡åˆ°çš„é—®é¢˜ éƒ¨ç½²å®Œæˆå´æ²¡æœ‰ç”Ÿæˆæ–‡ä»¶ï¼Œå°±åªæœ‰ä¸€ä¸ª.nojekyll æ–‡ä»¶\n1 \u003c!â€“ actions log â€“\u003e 2 cp: no such file or directory: /home/runner/work/blog/hugo/public/*\næ’æŸ¥æ€è·¯ï¼šæ’æŸ¥ Github Actions æ—¥å¿—ï¼Œä»¥åŠå†™ä¸€äº› shell å‘½ä»¤æŸ¥çœ‹è·¯å¾„ç›¸å…³ä¿¡æ¯\nHugo ç”Ÿæˆé™æ€æ–‡ä»¶æŠ¥é”™ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š\n1 - unmarshal failed: Near line 4 (last key parsed â€™tagsâ€™): Array contains values of type â€˜Integerâ€™ and â€˜Stringâ€™, but arrays must be homogeneous.\nåŸå› ï¼štags çš„ç±»å‹ä¸ä¸€è‡´ï¼Œæ ‡ç­¾æ··ç”¨äº†æ•°å­—å’Œå­—ç¬¦ä¸² è§£å†³æ–¹æ¡ˆï¼šå»æ‰æ•°å­—ç±»å‹çš„æ ‡ç­¾æˆ–å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬çš„ hugo\n2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown æ¥ä¸Šç¯‡ ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages\n2.1 ç—›ç‚¹ ä»£ç ä»“åº“é‡Œä¼šåŒæ—¶ä¿å­˜ org æ–‡ä»¶å’Œ markdown æ–‡ä»¶ï¼Œmarkdown æ–‡ä»¶å…¶å®æ˜¯ä¸­é—´äº§ç‰©ï¼Œä¸æƒ³ä¿å­˜ã€‚\n2.2 å¦‚ä½•è§£å†³ é¦–å…ˆï¼ŒEmacs æ˜¯å¯ä»¥æ‰§è¡Œ Emacs Script çš„ï¼Œå†™ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨ Github Action é‡Œæ‰§è¡Œå³å¯ã€‚Emacs ç¯å¢ƒå“ªé‡Œæ¥ï¼Ÿ purcell å¤§ç¥å·²ç»å‡†å¤‡å¥½äº†ã€‚\nåºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ã€‚\nåµŒå…¥ Gist\n1 #+BEGIN_EXPORT html 2 ","wordCount":"2549","inLanguage":"zh-cn","datePublished":"2023-09-05T00:00:00Z","dateModified":"2023-09-05T00:00:00Z","author":[{"@type":"Person","name":"Yang"},{"@type":"Person","name":"Ying-chao"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://yangyingchao.github.io/posts/how-this-blog-is-generated/"},"publisher":{"@type":"Organization","name":"MyNotes","logo":{"@type":"ImageObject","url":"https://yangyingchao.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yangyingchao.github.io accesskey=h title="MyNotes (Alt + H)">MyNotes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yangyingchao.github.io/ title=Home><span>Home</span></a></li><li><a href=https://yangyingchao.github.io/posts/ title=Archives><span>Archives</span></a></li><li><a href=https://yangyingchao.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://yangyingchao.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://yangyingchao.github.io/contact/ title="Contact me"><span>Contact me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>è¿™ä¸ªåšå®¢æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ</h1><div class=post-meta><span title='2023-09-05 00:00:00 +0000 UTC'>September 5, 2023</span>&nbsp;Â·&nbsp;Yang, Ying-chao</div></header><div class=post-content><ul><li>1 <a href=#h:77d4f63b-c1fa-4f57-93b5-c757e41e1a71>ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages</a><ul><li>1.1 <a href=#h:ae0cb92a-bd96-42bf-9858-deed2ae7d6e4>å‡†å¤‡å·¥ä½œ</a></li><li>1.2 <a href=#h:a50720d1-7467-43fe-96bf-c99596239cae>å†™åšå®¢</a></li><li>1.3 <a href=#h:fb08f300-8df9-412a-8a7e-0a5978f7d02a>éƒ¨ç½²ç¯‡</a></li><li>1.4 <a href=#h:3d56e5b1-24da-4c13-a233-241622c7a523>é‡åˆ°çš„é—®é¢˜</a></li></ul></li><li>2 <a href=#h:3dab7760-3b4f-456e-b112-e2e740204576>ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown</a><ul><li>2.1 <a href=#h:d959fa6b-ae45-41e4-8da5-fd800606a0e6>ç—›ç‚¹</a></li><li>2.2 <a href=#h:c5499c54-d782-4a29-b13c-e4e74d749915>å¦‚ä½•è§£å†³</a></li><li>2.3 <a href=#h:b08e34c0-315f-43a9-9b4a-cc087fb86323>å­˜åœ¨çš„é—®é¢˜</a></li><li>2.4 <a href=#h:43b5e31b-6034-4c46-bb48-782b103d0536>é‡åˆ°çš„é—®é¢˜</a></li></ul></li><li>3 <a href=#h:7d9d2a30-9a98-4243-8da6-51eb1201b20e>é™„å½•</a><ul><li>3.1 <a href=#h:bbb920e4-d3fe-48e3-9221-e4c6c5b53844>æˆ‘æ­£åœ¨ç”¨çš„ github actions</a></li><li>3.2 <a href=#h:006ec282-c3c0-4055-9d39-f9f564afd922>å½“å‰ç”¨çš„è„šæœ¬</a></li></ul></li></ul><p>å‚è€ƒè¿™é‡Œï¼š</p><ul><li><a href=https://superbear.github.io/post/2021/11/use-org-mode-and-hugo-to-write-blog/>https://superbear.github.io/post/2021/11/use-org-mode-and-hugo-to-write-blog/</a></li><li><a href=https://superbear.github.io/post/2021/12/batch-export-org-files-to-markdown-with-emacs-script-and-ox-hugo/>https://superbear.github.io/post/2021/12/batch-export-org-files-to-markdown-with-emacs-script-and-ox-hugo/</a></li></ul><p>æ¬è¿ä¸€ä¸‹ï¼Œæ”¾ä¸¢ã€‚ã€‚ã€‚</p><p>ä»¥ä¸‹å†…å®¹è½¬è‡ª superbear çš„åšå®¢ã€‚</p><h2 id=h:77d4f63b-c1fa-4f57-93b5-c757e41e1a71>1 ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages<a hidden class=anchor aria-hidden=true href=#h:77d4f63b-c1fa-4f57-93b5-c757e41e1a71>#</a></h2><h3 id=h:ae0cb92a-bd96-42bf-9858-deed2ae7d6e4>1.1 å‡†å¤‡å·¥ä½œ<a hidden class=anchor aria-hidden=true href=#h:ae0cb92a-bd96-42bf-9858-deed2ae7d6e4>#</a></h3><h4 id=h:be11c5fd-358f-4257-a3de-991dacf33dfa>1.1.1 åˆ›å»ºä¸¤ä¸ª Github ä»“åº“<a hidden class=anchor aria-hidden=true href=#h:be11c5fd-358f-4257-a3de-991dacf33dfa>#</a></h4><ul><li>ç”¨æ¥æ”¾ org æ–‡ä»¶. markdown æ–‡ä»¶åŠ Hugo ç›¸å…³é…ç½®ï¼Œå¯ä»¥è®¾ç½®æˆç§æœ‰ï¼Œå¦‚ blogã€‚</li><li>Github Pages ä»“åº“ï¼Œç”¨æ¥æ”¾ç”Ÿæˆçš„é™æ€æ–‡ä»¶ã€‚ä¸€èˆ¬æ˜¯{username}.github.ioã€‚</li></ul><h4 id=h:590f68ab-9703-405b-8365-c2b1805bb518>1.1.2 å®‰è£… Hugo<a hidden class=anchor aria-hidden=true href=#h:590f68ab-9703-405b-8365-c2b1805bb518>#</a></h4><ul><li>a static site generator written in Go</li></ul><h4 id=h:16bf7be3-b1f1-480f-a90a-194c11970799>1.1.3 å®‰è£… ox-hugo<a hidden class=anchor aria-hidden=true href=#h:16bf7be3-b1f1-480f-a90a-194c11970799>#</a></h4><ul><li>å°† org æ–‡ä»¶ç¿»è¯‘æˆ markdown æ–‡ä»¶ï¼Œwritten in Emacs Lispã€‚Hugo æ”¯æŒ Org Modeï¼Œä½†æ®è¯´æ”¯æŒå¾—ä¸æ˜¯å¾ˆå¥½ 1ã€‚
æ¯•ç«Ÿ Emacs Lisp å¤„ç† org æ–‡ä»¶ç›¸å…³çš„åŒ…æ¯” Go å¤šï¼Œå°±ç›´æ¥ç”¨ ox-hugo è½¬ markdown çš„æ–¹æ¡ˆäº†ã€‚</li></ul><p>ä¸æ˜¯ Emacs ç”¨æˆ·ï¼Ÿ</p><ul><li>å¯è·³è¿‡ Org Mode ç›¸å…³å†…å®¹</li></ul><h4 id=h:221b082e-bedf-46ae-9957-6eb4272b962d>1.1.4 é…ç½®ç¯å¢ƒ<a hidden class=anchor aria-hidden=true href=#h:221b082e-bedf-46ae-9957-6eb4272b962d>#</a></h4><p>å„è½¯ä»¶ç‰ˆæœ¬</p><ul><li><p>Emacs 27.1</p></li><li><p>Org Mode 9.3</p></li><li><p>ox-hugo 20210916.1332</p></li><li><p>Hugo v0.89.4</p></li><li><p>é…ç½® Hugo</p><ol><li># åœ¨ blog ä»“åº“ä¸­æ–°å»º hugo site</li><li>cd /path/to/blog && hugo new site hugo</li><li># é€‰ä¸ªä¸»é¢˜ï¼Œå¹¶è®¾ç½®æˆå­æ¨¡å—ï¼ˆåç»­å‡çº§/æ›¿æ¢éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼‰</li><li>git submodule add <a href=https://github.com/olOwOlo/hugo-theme-even.git>https://github.com/olOwOlo/hugo-theme-even.git</a> hugo/themes/even</li><li># ä¿®æ”¹é»˜è®¤é…ç½®</li></ol></li><li><p>å¼€å¯æœ¬åœ°å®æ—¶é¢„è§ˆ</p><ol><li># é…ç½®ä¿®æ”¹. markdown æ–‡ä»¶æ”¹åŠ¨éƒ½ä¼šè¢«ç›‘æ§åˆ°</li><li>cd blog && hugo â€“source hugo server -D</li></ol></li><li><p>é…ç½® ox-hugo</p></li></ul><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; åœ¨ init.el é‡Œæˆ–å…¶ä»–æ–‡ä»¶é‡ŒåŠ ä»¥ä¸‹ä»£ç </span>
</span></span><span style=display:flex><span>(<span style=color:green>with-eval-after-load</span> <span style=color:#19177c>&#39;ox</span>
</span></span><span style=display:flex><span>  (<span style=color:green>require</span> <span style=color:#19177c>&#39;ox-hugo</span>))
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; å¯é€‰ã€‚å…¨å±€é…ç½®ï¼Œå¦‚å¯¼å‡ºç›®å½•ç­‰å­—æ®µï¼Œä¹Ÿå¯ä»¥åœ¨ org æ–‡ä»¶é‡Œè¿›è¡Œé…ç½®</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; M-x customize-variable org-hugo</span>
</span></span></code></pre></div><h3 id=h:a50720d1-7467-43fe-96bf-c99596239cae>1.2 å†™åšå®¢<a hidden class=anchor aria-hidden=true href=#h:a50720d1-7467-43fe-96bf-c99596239cae>#</a></h3><ol><li><p>æ–°å»º org ç›®å½•åŠæ–‡ä»¶</p><ol><li>cd blog && mkdir -p org/2021/11</li><li># å¯é€‰ï¼Œå¯ä»¥ä¸æŒ‰å¹´æœˆæ—¥åˆ†æ‹†åˆ†ç›®å½•ã€‚æ‹†åˆ†åæ–¹ä¾¿ç®¡ç†ï¼Œä½†å¦‚æœç”¨æˆ·ç›´æ¥è®¿é—®æŸå¹´çš„æ•°æ®ï¼Œé¡µé¢å°±ä¼š 404</li></ol></li><li><p>æ–°å»º org æ–‡ä»¶ï¼Œå¦‚ test.org</p></li></ol><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-org data-lang=org><span style=display:flex><span><span style=color:#408080;font-style:italic>#+OPTIONS</span><span style=color:#408080;font-style:italic>: author:nil ^:{}</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># å‘Šè¯‰ ox-hugo å°†å¯¼å‡ºçš„ markdown æ–‡ä»¶æ”¾åˆ°å“ªé‡Œã€‚æ³¨æ„ï¼ševen ä¸»é¢˜éœ€è¦å‘å¸ƒåˆ° post ç›®å½•ã€‚</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># see: https://ox-hugo.scripter.co/#before-you-export</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_BASE_DIR</span><span style=color:#408080;font-style:italic>: ../../../hugo</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_SECTION</span><span style=color:#408080;font-style:italic>: post/2021/11</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_CUSTOM_FRONT_MATTER</span><span style=color:#408080;font-style:italic>: :toc true</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_AUTO_SET_LASTMOD</span><span style=color:#408080;font-style:italic>: t</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_DRAFT</span><span style=color:#408080;font-style:italic>: false</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+DATE</span><span style=color:#408080;font-style:italic>: [2021-11-28 Sun 19:28]</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+TITLE</span><span style=color:#408080;font-style:italic>: æ ‡é¢˜</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_TAGS</span><span style=color:#408080;font-style:italic>: tag1 tag2</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>#+HUGO_CATEGORIES</span><span style=color:#408080;font-style:italic>: category1 category2</span>
</span></span><span style=display:flex><span>Helloï¼ŒWorld
</span></span></code></pre></div><ol><li><p>å¯¼å‡º org åˆ° markdown æ–‡ä»¶</p></li><li><p>åœ¨ Emacs é‡Œæ‰§è¡Œ C-c C-e H hï¼ˆFile to Md fileï¼‰å¯¼å‡ºæ•´ä¸ª org æ–‡ä»¶åˆ° markdown æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥å¯¼å‡º subtreeï¼Œ
å…·ä½“çœ‹ä¸ªäººå–œå¥½</p></li><li><p>è®¿é—®<a href=http://127.0.0.1:1313/>http://127.0.0.1:1313/</a></p></li><li><p>æ­£å¸¸æƒ…å†µå°±ä¼šçœ‹åˆ°åšå®¢ç•Œé¢å•¦</p></li><li><p>æäº¤ org åŠ markdown æ–‡ä»¶åˆ° blog ä»“åº“</p></li><li><p>ä½¿ç”¨ Yasnippetï¼ˆæ¨èï¼‰ ä¸‹æ¬¡æ–°å»ºæ–‡ä»¶å°±ä¸ç”¨ copy ä¸€äº›å…ƒæ•°æ®</p></li></ol><pre tabindex=0><code class=language-snippet data-lang=snippet># -*- mode: snippet -*-
# name: hugo
# key: hugo
# --
#+OPTIONS: author:nil ^:{}
#+HUGO_BASE_DIR: ../../../hugo
#+HUGO_SECTION: post/`(format-time-string &#34;%Y/%m&#34;)`
#+HUGO_CUSTOM_FRONT_MATTER: :toc true
#+HUGO_AUTO_SET_LASTMOD: t
#+HUGO_DRAFT: false
#+DATE: `(format-time-string &#34;[%Y-%m-%d %a %H:%M]&#34;)`
#+TITLE: $1
#+HUGO_TAGS: $2
#+HUGO_CATEGORIES: $3
$0
</code></pre><h4 id=h:2a8af21d-c8c0-41f1-8925-1c7a68063f84>1.2.1 ç›®å½•ç»“æ„<a hidden class=anchor aria-hidden=true href=#h:2a8af21d-c8c0-41f1-8925-1c7a68063f84>#</a></h4><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span> &lt;!-- blog ä»“åº“ç›®å½•ç»“æ„å¦‚ä¸‹ --&gt;
</span></span><span style=display:flex><span>  &lt;!-- tree -a -d -L 3 -I .git --&gt;
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>â”œâ”€â”€ .github
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ workflows
</span></span><span style=display:flex><span>â”œâ”€â”€ hugo
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ archetypes
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ content
</span></span><span style=display:flex><span>â”‚   â”‚   â””â”€â”€ post
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ data
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ layouts
</span></span><span style=display:flex><span>â”‚   â”‚   â””â”€â”€ _internal
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ static
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ themes
</span></span><span style=display:flex><span>â”‚       â””â”€â”€ even
</span></span><span style=display:flex><span>â”œâ”€â”€ org
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ 2021
</span></span><span style=display:flex><span>â”‚       â””â”€â”€ 11
</span></span><span style=display:flex><span>â””â”€â”€ scripts
</span></span></code></pre></div><h3 id=h:fb08f300-8df9-412a-8a7e-0a5978f7d02a>1.3 éƒ¨ç½²ç¯‡<a hidden class=anchor aria-hidden=true href=#h:fb08f300-8df9-412a-8a7e-0a5978f7d02a>#</a></h3><h4 id=h:c47c61b5-6463-4b58-a111-0c975a87abf2>1.3.1 é…ç½® Github Action<a hidden class=anchor aria-hidden=true href=#h:c47c61b5-6463-4b58-a111-0c975a87abf2>#</a></h4><p>åœ¨ blog ä»“åº“ä¸‹æ–°å¢.github/workflows/main.yml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>GitHub Pages<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>on</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>push</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>branches</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- main <span style=color:#bbb> </span><span style=color:#408080;font-style:italic># Set a branch to deploy</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>pull_request</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>jobs</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>deploy</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>runs-on</span>:<span style=color:#bbb> </span>ubuntu-20.04<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>concurrency</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>group</span>:<span style=color:#bbb> </span>${{ github.workflow }}-${{ github.ref }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>steps</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#408080;font-style:italic># ä¿®æ”¹æ—¶åŒº</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Set Timezone<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>run</span>:<span style=color:#bbb> </span>sudo timedatectl set-timezone &#39;Asia/Shanghai&#39;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>actions/checkout@v2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>submodules</span>:<span style=color:#bbb> </span><span style=color:green;font-weight:700>true</span><span style=color:#bbb>  </span><span style=color:#408080;font-style:italic># Fetch Hugo themes (true OR recursive)</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>fetch-depth</span>:<span style=color:#bbb> </span><span style=color:#666>0</span><span style=color:#bbb>    </span><span style=color:#408080;font-style:italic># Fetch all history for .GitInfo and .Lastmod</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Setup Hugo<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>peaceiris/actions-hugo@v2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># å»ºè®®å’Œæœ¬åœ°ç”¨çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼Œä»è€Œè·å¾—ä¸€è‡´çš„ä½“éªŒ</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>hugo-version</span>:<span style=color:#bbb> </span><span style=color:#ba2121>&#39;0.89.4&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># extended: true</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Build<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>run</span>:<span style=color:#bbb> </span>|<span style=color:#ba2121;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic>          hugo --source hugo --minify --buildFuture --buildExpired</span><span style=color:#bbb>          
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Deploy<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>peaceiris/actions-gh-pages@v3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>if</span>:<span style=color:#bbb> </span>${{ github.ref == &#39;refs/heads/main&#39; }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># github_token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># publish_branch: gh-pages</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># publish_dir: hugo/public</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>deploy_key</span>:<span style=color:#bbb> </span>${{ secrets.DEPLOY_KEY }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>external_repository</span>:<span style=color:#bbb> </span>superbear/superbear.github.io<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:#408080;font-style:italic># é»˜è®¤æ˜¯ master ç›®å½•ï¼Œgithub ä¸Šå¯ä¿®æ”¹</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>publish_branch</span>:<span style=color:#bbb> </span>master<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>publish_dir</span>:<span style=color:#bbb> </span>hugo/public<span style=color:#bbb>
</span></span></span></code></pre></div><h4 id=h:fe0a2943-fea6-4455-a7c4-3300df3ed776>1.3.2 é…ç½® DEPLOY_KEY<a hidden class=anchor aria-hidden=true href=#h:fe0a2943-fea6-4455-a7c4-3300df3ed776>#</a></h4><p>ç”Ÿæˆ github deploy-keys</p><ol><li>å°†å…¬é’¥æ·»åŠ è‡³{username}.github.io ä»“çš„ Deploy keysï¼ˆSettings -> Deploy keysï¼‰ä¸­ï¼›</li><li>å°†ç§é’¥æ·»åŠ è‡³ blog ä»“åº“çš„ secretsï¼ˆSettings -> Secretsï¼‰ä¸­ï¼›</li><li>å°†æœ¬åœ° blog ç›®å½•çš„æ”¹åŠ¨ push åˆ°è¿œç¨‹ blog ä»“åº“ master åˆ†æ”¯ï¼›</li><li>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€æ®µæ—¶é—´ä¹‹åï¼Œå¯ä»¥åœ¨{username}.github.io çš„ master åˆ†æ”¯ä¸‹çœ‹åˆ° hugo ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼›</li><li>æ²¡æœ‰çš„è¯ï¼Œå¯ä»¥æ ¹æ® blog ä»“åº“çš„ Github Actions æ—¥å¿—æ’æŸ¥ä¸‹ã€‚</li></ol><h3 id=h:3d56e5b1-24da-4c13-a233-241622c7a523>1.4 é‡åˆ°çš„é—®é¢˜<a hidden class=anchor aria-hidden=true href=#h:3d56e5b1-24da-4c13-a233-241622c7a523>#</a></h3><ol><li><p>éƒ¨ç½²å®Œæˆå´æ²¡æœ‰ç”Ÿæˆæ–‡ä»¶ï¼Œå°±åªæœ‰ä¸€ä¸ª.nojekyll æ–‡ä»¶</p><p>1 &lt;!â€“ actions log â€“>
2 cp: no such file or directory: /home/runner/work/blog/hugo/public/*</p></li></ol><p>æ’æŸ¥æ€è·¯ï¼šæ’æŸ¥ Github Actions æ—¥å¿—ï¼Œä»¥åŠå†™ä¸€äº› shell å‘½ä»¤æŸ¥çœ‹è·¯å¾„ç›¸å…³ä¿¡æ¯</p><ol><li><p>Hugo ç”Ÿæˆé™æ€æ–‡ä»¶æŠ¥é”™ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p>1 - unmarshal failed: Near line 4 (last key parsed &rsquo;tags&rsquo;): Array contains values of type &lsquo;Integer&rsquo; and &lsquo;String&rsquo;, but arrays must be homogeneous.</p></li></ol><p>åŸå› ï¼štags çš„ç±»å‹ä¸ä¸€è‡´ï¼Œæ ‡ç­¾æ··ç”¨äº†æ•°å­—å’Œå­—ç¬¦ä¸²
è§£å†³æ–¹æ¡ˆï¼šå»æ‰æ•°å­—ç±»å‹çš„æ ‡ç­¾æˆ–å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬çš„ hugo</p><h2 id=h:3dab7760-3b4f-456e-b112-e2e740204576>2 ä½¿ç”¨ Emacs Script è‡ªåŠ¨å°† org æ–‡ä»¶å¯¼å‡ºä¸º Markdown<a hidden class=anchor aria-hidden=true href=#h:3dab7760-3b4f-456e-b112-e2e740204576>#</a></h2><p>æ¥ä¸Šç¯‡ ç”¨ Org Mode + Hugo å†™åšå®¢ï¼Œå¹¶é€šè¿‡ Github Action è‡ªåŠ¨éƒ¨ç½²åˆ° Github Pages</p><h3 id=h:d959fa6b-ae45-41e4-8da5-fd800606a0e6>2.1 ç—›ç‚¹<a hidden class=anchor aria-hidden=true href=#h:d959fa6b-ae45-41e4-8da5-fd800606a0e6>#</a></h3><p>ä»£ç ä»“åº“é‡Œä¼šåŒæ—¶ä¿å­˜ org æ–‡ä»¶å’Œ markdown æ–‡ä»¶ï¼Œmarkdown æ–‡ä»¶å…¶å®æ˜¯ä¸­é—´äº§ç‰©ï¼Œä¸æƒ³ä¿å­˜ã€‚</p><h3 id=h:c5499c54-d782-4a29-b13c-e4e74d749915>2.2 å¦‚ä½•è§£å†³<a hidden class=anchor aria-hidden=true href=#h:c5499c54-d782-4a29-b13c-e4e74d749915>#</a></h3><p>é¦–å…ˆï¼ŒEmacs æ˜¯å¯ä»¥æ‰§è¡Œ Emacs Script çš„ï¼Œå†™ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨ Github Action é‡Œæ‰§è¡Œå³å¯ã€‚Emacs ç¯å¢ƒå“ªé‡Œæ¥ï¼Ÿ
purcell å¤§ç¥å·²ç»å‡†å¤‡å¥½äº†ã€‚</p><p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ã€‚</p><p>åµŒå…¥ Gist</p><p>1 #+BEGIN_EXPORT html
2 &lt;script src="<a href=https://gist.github.com/superbear/28fb0dbbca505b5d7d83e10e35b822a4.js>https://gist.github.com/superbear/28fb0dbbca505b5d7d83e10e35b822a4.js</a>">&lt;/script>
3 #+END_EXPORT</p><p>ç­‰ç­‰ï¼Œç›´æ¥ç”¨ markdown å†™æ˜¯ä¸æ˜¯å°±æ²¡æœ‰è¿™ä¸ªç—›ç‚¹äº†ï¼Ÿå—¯ğŸ˜„ã€‚</p><h3 id=h:b08e34c0-315f-43a9-9b4a-cc087fb86323>2.3 å­˜åœ¨çš„é—®é¢˜<a hidden class=anchor aria-hidden=true href=#h:b08e34c0-315f-43a9-9b4a-cc087fb86323>#</a></h3><p>ç›®å‰æ˜¯å…¨é‡å¯¼å‡ºï¼Œæ‰¾åˆ°æŒ‡å®šç›®å½•ä¸‹çš„å…¨éƒ¨ org æ–‡ä»¶ï¼Œç„¶åè½¬æˆ markdown æ–‡ä»¶ã€‚ è¿™æ ·æ¯æäº¤ä¸€ç¯‡æ–‡ç« ï¼Œå°±éœ€è¦
å¤„ç†å…¨éƒ¨å­˜é‡æ–‡ç« ã€‚å¦å¤–ï¼Œå…¨éƒ¨æ–‡ç« çš„æ›´æ–°æ—¶é—´éƒ½ä¼šè·Ÿç€å˜ï¼Œè¿™ä¸ªå’Œ HUGO_AUTO_SET_LASTMOD è¿™ä¸ª property
è®¾ç½®æœ‰å…³ã€‚è¯¦è§ï¼šox-hugo last modified ã€‚å¾…æ”¹æˆå¢é‡å¯¼å‡ºã€‚</p><h3 id=h:43b5e31b-6034-4c46-bb48-782b103d0536>2.4 é‡åˆ°çš„é—®é¢˜<a hidden class=anchor aria-hidden=true href=#h:43b5e31b-6034-4c46-bb48-782b103d0536>#</a></h3><ol><li>org å¯¼å‡º markdown æ–‡ä»¶äº†ï¼Œä½†æœªç”Ÿæˆé™æ€æ–‡ä»¶</li></ol><p>åŸå› ï¼šæ—¶åŒºé—®é¢˜ã€‚Github Action æ˜¯æŒ‰ UTC æ—¶é—´æ‰§è¡Œçš„ï¼Œè€Œæ–‡ä»¶çš„å‘å¸ƒæ—¥æœŸæ˜¯ä¸œå…«åŒºçš„ï¼Œè¿™æ · Hugo å¯èƒ½ä¼šçœ‹åˆ°
å‘å¸ƒæ—¥æœŸè¿˜æœªåˆ°ï¼Œå°±ä¸å¤„ç†äº† 1ã€‚
è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹ Github Action job çš„æ—¶åŒºï¼Œå¯ä¸€å¹¶è§£å†³æ–‡ä»¶ä¿®æ”¹æ—¶é—´ä¸å¯¹çš„é—®é¢˜ï¼›æˆ–ä¿®æ”¹ Hugo è¿è¡Œæ—¶çš„é…
ç½®ï¼Œå¢åŠ â€“buildFuture å‚æ•°ã€‚</p><h2 id=h:7d9d2a30-9a98-4243-8da6-51eb1201b20e>3 é™„å½•<a hidden class=anchor aria-hidden=true href=#h:7d9d2a30-9a98-4243-8da6-51eb1201b20e>#</a></h2><h3 id=h:bbb920e4-d3fe-48e3-9221-e4c6c5b53844>3.1 æˆ‘æ­£åœ¨ç”¨çš„ github actions<a hidden class=anchor aria-hidden=true href=#h:bbb920e4-d3fe-48e3-9221-e4c6c5b53844>#</a></h3><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#408080;font-style:italic># Sample workflow for building and deploying a Hugo site to GitHub Pages</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Deploy Hugo site to Pages<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>on</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#408080;font-style:italic># Runs on pushes targeting the default branch</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>push</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>branches</span>:<span style=color:#bbb> </span>[<span style=color:#ba2121>&#34;master&#34;</span>]<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#408080;font-style:italic># Allows you to run this workflow manually from the Actions tab</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>workflow_dispatch</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>permissions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>contents</span>:<span style=color:#bbb> </span>read<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>pages</span>:<span style=color:#bbb> </span>write<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>id-token</span>:<span style=color:#bbb> </span>write<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic># Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic># However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>concurrency</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>group</span>:<span style=color:#bbb> </span><span style=color:#ba2121>&#34;pages&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>cancel-in-progress</span>:<span style=color:#bbb> </span><span style=color:green;font-weight:700>false</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#408080;font-style:italic># Default to bash</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>defaults</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>run</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>shell</span>:<span style=color:#bbb> </span>bash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>jobs</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>build</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>runs-on</span>:<span style=color:#bbb> </span>ubuntu-20.04<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>concurrency</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>group</span>:<span style=color:#bbb> </span>${{ github.workflow }}-${{ github.ref }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>steps</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>actions/checkout@v2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>submodules</span>:<span style=color:#bbb> </span><span style=color:green;font-weight:700>true</span><span style=color:#bbb>  </span><span style=color:#408080;font-style:italic># Fetch Hugo themes (true OR recursive)</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>fetch-depth</span>:<span style=color:#bbb> </span><span style=color:#666>0</span><span style=color:#bbb>    </span><span style=color:#408080;font-style:italic># Fetch all history for .GitInfo and .Lastmod</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Setup Hugo<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>peaceiris/actions-hugo@v2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>hugo-version</span>:<span style=color:#bbb> </span><span style=color:#ba2121>&#39;0.115.0&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>extended</span>:<span style=color:#bbb> </span><span style=color:green;font-weight:700>true</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Setup Emacs<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>purcell/setup-emacs@master<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>version</span>:<span style=color:#bbb> </span><span style=color:#666>29.1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Export Markdown<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>run</span>:<span style=color:#bbb> </span>|<span style=color:#ba2121;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic>          # å°†orgæ–‡ä»¶å¯¼å‡ºæˆmdæ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic>          mkdir ~/.emacs.d
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic>          cd script &amp;&amp; sh batch-export-org-files-to-md-with-ox-hugo.el</span><span style=color:#bbb>          
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Build<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>run</span>:<span style=color:#bbb> </span>|<span style=color:#ba2121;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#ba2121;font-style:italic>          cd hugo &amp;&amp; hugo --minify --buildFuture --buildExpired</span><span style=color:#bbb>          
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Upload artifact<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>actions/upload-pages-artifact@v2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>path</span>:<span style=color:#bbb> </span>./hugo/public<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>Deploy<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>uses</span>:<span style=color:#bbb> </span>peaceiris/actions-gh-pages@v3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#408080;font-style:italic># If you&#39;re changing the branch from main,</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#408080;font-style:italic># also change the `main` in `refs/heads/main`</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:#408080;font-style:italic># below accordingly.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>if</span>:<span style=color:#bbb> </span>github.ref == &#39;refs/heads/master&#39;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>with</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>publish_branch</span>:<span style=color:#bbb> </span>master<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>publish_dir</span>:<span style=color:#bbb> </span>hugo/public<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>deploy_key</span>:<span style=color:#bbb> </span>${{ secrets.DEPLOY }}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>external_repository</span>:<span style=color:#bbb> </span>yangyingchao/yangyingchao.github.io<span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=h:006ec282-c3c0-4055-9d39-f9f564afd922>3.2 å½“å‰ç”¨çš„è„šæœ¬<a hidden class=anchor aria-hidden=true href=#h:006ec282-c3c0-4055-9d39-f9f564afd922>#</a></h3><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-emacs-lisp data-lang=emacs-lisp><span style=display:flex><span><span>#</span><span style=color:#19177c>!/usr/bin/env</span> <span style=color:#19177c>sh</span>
</span></span><span style=display:flex><span><span style=color:#666>:</span><span style=color:#408080;font-style:italic>; set -e # -*- mode: emacs-lisp; lexical-binding: t -*-</span>
</span></span><span style=display:flex><span><span style=color:#666>:</span><span style=color:#408080;font-style:italic>; emacs --no-site-file --script &#34;$0&#34; -- &#34;$@&#34; || __EXITCODE=$?</span>
</span></span><span style=display:flex><span><span style=color:#666>:</span><span style=color:#408080;font-style:italic>; exit 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; Code:</span>
</span></span><span style=display:flex><span>(<span style=color:green>defvar</span> <span style=color:#19177c>bootstrap-version</span>)
</span></span><span style=display:flex><span>(<span style=color:green>defvar</span> <span style=color:#19177c>straight-base-dir</span>)
</span></span><span style=display:flex><span>(<span style=color:green>defvar</span> <span style=color:#19177c>straight-fix-org</span>)
</span></span><span style=display:flex><span>(<span style=color:green>defvar</span> <span style=color:#19177c>straight-vc-git-default-clone-depth</span> <span style=color:#666>1</span>)
</span></span><span style=display:flex><span>(<span style=color:green>defvar</span> <span style=color:#19177c>publish--straight-repos-dir</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>setq</span> <span style=color:#19177c>gc-cons-threshold</span> <span style=color:#666>83886080</span> <span style=color:#408080;font-style:italic>; 80MiB</span>
</span></span><span style=display:flex><span>      <span style=color:#19177c>straight-base-dir</span> (<span style=color:#00f>expand-file-name</span> <span style=color:#ba2121>&#34;../..&#34;</span> (<span style=color:green>or</span> <span style=color:#19177c>load-file-name</span> <span style=color:#00f>buffer-file-name</span>))
</span></span><span style=display:flex><span>      <span style=color:#19177c>straight-fix-org</span> <span style=color:#800>t</span>
</span></span><span style=display:flex><span>      <span style=color:#19177c>straight-vc-git-default-clone-depth</span> <span style=color:#666>1</span>
</span></span><span style=display:flex><span>      <span style=color:#19177c>publish--straight-repos-dir</span> (<span style=color:#00f>expand-file-name</span> <span style=color:#ba2121>&#34;straight/repos/&#34;</span> <span style=color:#19177c>straight-base-dir</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>let</span> ((<span style=color:#19177c>bootstrap-file</span> (<span style=color:#00f>expand-file-name</span> <span style=color:#ba2121>&#34;straight/repos/straight.el/bootstrap.el&#34;</span> <span style=color:#19177c>straight-base-dir</span>))
</span></span><span style=display:flex><span>      (<span style=color:#19177c>bootstrap-version</span> <span style=color:#666>5</span>))
</span></span><span style=display:flex><span>  (<span style=color:green>unless</span> (<span style=color:#00f>file-exists-p</span> <span style=color:#19177c>bootstrap-file</span>)
</span></span><span style=display:flex><span>    (<span style=color:green>with-current-buffer</span>
</span></span><span style=display:flex><span>        (<span style=color:#19177c>url-retrieve-synchronously</span>
</span></span><span style=display:flex><span>         <span style=color:#ba2121>&#34;https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el&#34;</span>
</span></span><span style=display:flex><span>         <span style=color:#19177c>&#39;silent</span> <span style=color:#19177c>&#39;inhibit-cookies</span>)
</span></span><span style=display:flex><span>      (<span style=color:#00f>goto-char</span> (<span style=color:#00f>point-max</span>))
</span></span><span style=display:flex><span>      (<span style=color:#19177c>eval-print-last-sexp</span>)))
</span></span><span style=display:flex><span>  (<span style=color:#00f>load</span> <span style=color:#19177c>bootstrap-file</span> <span style=color:#800>nil</span> <span style=color:#19177c>&#39;nomessage</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; org &amp;&amp; ox-hugo</span>
</span></span><span style=display:flex><span>(<span style=color:#19177c>straight-use-package</span> <span style=color:#666>&#39;</span>(<span style=color:#19177c>org</span> <span style=color:green>:type</span> <span style=color:#19177c>built-in</span>))
</span></span><span style=display:flex><span>(<span style=color:#19177c>straight-use-package</span>
</span></span><span style=display:flex><span> <span style=color:#666>&#39;</span>(<span style=color:#19177c>ox-hugo</span> <span style=color:green>:type</span> <span style=color:#19177c>git</span>
</span></span><span style=display:flex><span>           <span style=color:green>:host</span> <span style=color:#19177c>github</span>
</span></span><span style=display:flex><span>           <span style=color:green>:repo</span> <span style=color:#ba2121>&#34;kaushalmodi/ox-hugo&#34;</span>
</span></span><span style=display:flex><span>           <span style=color:green>:nonrecursive</span> <span style=color:#800>t</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>require</span> <span style=color:#19177c>&#39;ox-hugo</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>defun</span> <span style=color:#19177c>yc/org-hugo--build-toc-a</span> (<span style=color:#19177c>content</span>)
</span></span><span style=display:flex><span>  <span style=color:#ba2121>&#34;Append my markers.
</span></span></span><span style=display:flex><span><span style=color:#ba2121>
</span></span></span><span style=display:flex><span><span style=color:#ba2121>These markers are used to identify original source of this note.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#00f>concat</span> (<span style=color:green>or</span> <span style=color:#19177c>content</span> <span style=color:#ba2121>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    (<span style=color:green>save-excursion</span>
</span></span><span style=display:flex><span>      (<span style=color:#00f>goto-char</span> (<span style=color:#00f>point-min</span>))
</span></span><span style=display:flex><span>      (<span style=color:green>if</span> (<span style=color:#00f>re-search-forward</span> (<span style=color:green>rx</span> <span style=color:#19177c>bol</span> <span style=color:#ba2121>&#34;:NOTER_DOCUMENT:&#34;</span> (<span style=color:#00f>*</span> <span style=color:#19177c>space</span>) (<span style=color:#19177c>group</span> (<span style=color:#00f>+</span> <span style=color:#19177c>nonl</span>)) <span style=color:#19177c>eol</span>))
</span></span><span style=display:flex><span>          (<span style=color:green>let</span> ((<span style=color:#19177c>orig</span> (<span style=color:#19177c>match-string</span> <span style=color:#666>1</span>)))
</span></span><span style=display:flex><span>            (<span style=color:#00f>format</span> <span style=color:#ba2121>&#34;\n\næœ¬æ–‡ä¸ºæ‘˜å½•ï¼ŒåŸæ–‡ä¸ºï¼š %s\n&#34;</span> <span style=color:#19177c>orig</span>))
</span></span><span style=display:flex><span>        <span style=color:#ba2121>&#34;&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#19177c>advice-add</span> <span style=color:#00f>#&#39;</span><span style=color:#19177c>org-hugo--build-toc</span> <span style=color:green>:filter-return</span> <span style=color:#00f>#&#39;</span><span style=color:#19177c>yc/org-hugo--build-toc-a</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>defun</span> <span style=color:#19177c>tnote/export-org-file-to-md</span> (<span style=color:#19177c>file</span>)
</span></span><span style=display:flex><span>  <span style=color:#ba2121>&#34;Export single FILE to markdown.&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;Checking file %s&#34;</span> <span style=color:#19177c>file</span>)
</span></span><span style=display:flex><span>  (<span style=color:green>if</span> (<span style=color:green>and</span> (<span style=color:#00f>file-exists-p</span> <span style=color:#19177c>file</span>)
</span></span><span style=display:flex><span>           (<span style=color:#00f>string-equal</span> (<span style=color:#19177c>file-name-extension</span> <span style=color:#19177c>file</span>) <span style=color:#ba2121>&#34;org&#34;</span>)
</span></span><span style=display:flex><span>           (<span style=color:#19177c>not</span> (<span style=color:#19177c>string-match-p</span> (<span style=color:green>rx</span> (<span style=color:green>or</span> <span style=color:#ba2121>&#34;inbox&#34;</span> <span style=color:#ba2121>&#34;gtd&#34;</span>)) <span style=color:#19177c>file</span>)))
</span></span><span style=display:flex><span>            (<span style=color:green>with-current-buffer</span> (<span style=color:#19177c>find-file-noselect</span> <span style=color:#19177c>file</span>)
</span></span><span style=display:flex><span>        (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;    Processing file: %s&#34;</span> <span style=color:#19177c>file</span>)
</span></span><span style=display:flex><span>        (<span style=color:green>condition-case</span> <span style=color:#19177c>var</span>
</span></span><span style=display:flex><span>            (<span style=color:#19177c>org-hugo-export-wim-to-md</span> <span style=color:#800>t</span>)
</span></span><span style=display:flex><span>          (<span style=color:#d2413a;font-weight:700>error</span> (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;ERROR: %s&#34;</span> <span style=color:#19177c>var</span>)))
</span></span><span style=display:flex><span>        (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;    .... done&#34;</span>))
</span></span><span style=display:flex><span>    (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;    Skipping file: %s&#34;</span> <span style=color:#19177c>file</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>defun</span> <span style=color:#19177c>batch-export-all-org-files-to-md</span> (<span style=color:#19177c>dir</span>)
</span></span><span style=display:flex><span>  <span style=color:#ba2121>&#34;Export all org files in directory DIR to markdown.
</span></span></span><span style=display:flex><span><span style=color:#ba2121>
</span></span></span><span style=display:flex><span><span style=color:#ba2121>To perform a full export of all org files in the directory DIR to
</span></span></span><span style=display:flex><span><span style=color:#ba2121>markdown format, use this command. It should be called when a
</span></span></span><span style=display:flex><span><span style=color:#ba2121>full export is required, typically for the first time..&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:#00f>message</span> <span style=color:#ba2121>&#34;DIR: %s&#34;</span> <span style=color:#19177c>dir</span>)
</span></span><span style=display:flex><span>  (<span style=color:#00f>mapc</span> <span style=color:#00f>#&#39;</span><span style=color:#19177c>tnote/export-org-file-to-md</span> (<span style=color:#19177c>directory-files-recursively</span> <span style=color:#19177c>dir</span> <span style=color:#ba2121>&#34;\\`[^.#].*\\.org\\&#39;&#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:green>defun</span> <span style=color:#19177c>batch-export-HEAD-files-to-md</span> ()
</span></span><span style=display:flex><span>  <span style=color:#ba2121>&#34;Export the files in the HEAD branch to markdown format.
</span></span></span><span style=display:flex><span><span style=color:#ba2121>
</span></span></span><span style=display:flex><span><span style=color:#ba2121>This command should be called in an incremental manner to
</span></span></span><span style=display:flex><span><span style=color:#ba2121>effectively export updated files..&#34;</span>
</span></span><span style=display:flex><span>  (<span style=color:green>dolist</span> (<span style=color:#19177c>it</span> (<span style=color:#00f>cdr</span> (<span style=color:#19177c>string-lines</span> (<span style=color:#19177c>shell-command-to-string</span> <span style=color:#ba2121>&#34;git show --oneline --name-only HEAD&#34;</span>))))
</span></span><span style=display:flex><span>    (<span style=color:#19177c>tnote/export-org-file-to-md</span> (<span style=color:#00f>expand-file-name</span> <span style=color:#19177c>it</span> <span style=color:#ba2121>&#34;..&#34;</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic>;;; export</span>
</span></span><span style=display:flex><span>(<span style=color:green>setq</span> <span style=color:#19177c>org-hugo-base-dir</span> (<span style=color:#00f>concat</span> <span style=color:#19177c>default-directory</span> <span style=color:#ba2121>&#34;../hugo&#34;</span>))
</span></span><span style=display:flex><span>(<span style=color:green>setq</span> <span style=color:#19177c>org-file-dir</span> (<span style=color:#00f>concat</span> <span style=color:#19177c>default-directory</span> <span style=color:#ba2121>&#34;../org/&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#19177c>batch-export-all-org-files-to-md</span> <span style=color:#19177c>org-file-dir</span>)
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://yangyingchao.github.io/tags/hugo/>hugo</a></li><li><a href=https://yangyingchao.github.io/tags/blog/>blog</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://yangyingchao.github.io>MyNotes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>