<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>The mapping of oid and relfilenode in PG | MyNotes</title><meta name=keywords content><meta name=description content="1 Relfilenode of ordinary table 2 Relfilenode of Nail tables 3 Nail table Relfilenode storage mechanism 4 Summary 本文为摘录，原文为： https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/ A table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there"><meta name=author content><link rel=canonical href=https://yangyingchao.github.io/posts/the-mapping-of-oid-and-relfilenode-in-pg/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://yangyingchao.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yangyingchao.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yangyingchao.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://yangyingchao.github.io/apple-touch-icon.png><link rel=mask-icon href=https://yangyingchao.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="The mapping of oid and relfilenode in PG"><meta property="og:description" content="1 Relfilenode of ordinary table 2 Relfilenode of Nail tables 3 Nail table Relfilenode storage mechanism 4 Summary 本文为摘录，原文为： https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/ A table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there"><meta property="og:type" content="article"><meta property="og:url" content="https://yangyingchao.github.io/posts/the-mapping-of-oid-and-relfilenode-in-pg/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content="The mapping of oid and relfilenode in PG"><meta name=twitter:description content="1 Relfilenode of ordinary table 2 Relfilenode of Nail tables 3 Nail table Relfilenode storage mechanism 4 Summary 本文为摘录，原文为： https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/ A table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yangyingchao.github.io/posts/"},{"@type":"ListItem","position":2,"name":"The mapping of oid and relfilenode in PG","item":"https://yangyingchao.github.io/posts/the-mapping-of-oid-and-relfilenode-in-pg/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"The mapping of oid and relfilenode in PG","name":"The mapping of oid and relfilenode in PG","description":"1 Relfilenode of ordinary table 2 Relfilenode of Nail tables 3 Nail table Relfilenode storage mechanism 4 Summary 本文为摘录，原文为： https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/ A table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there","keywords":[],"articleBody":" 1 Relfilenode of ordinary table 2 Relfilenode of Nail tables 3 Nail table Relfilenode storage mechanism 4 Summary 本文为摘录，原文为： https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/\nA table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there are some specific tables whose query result in the relfilenode field is 0. This blog will explore the kernel processing of these special tables relfilenode.\n1 Relfilenode of ordinary table When a normal table is created in PostgreSQL, the relfilenode value of the table is stored in pg_class system table. As it can be seen in this example that when a table is created, it’s OID and relfilenode value are both 16808. You can also find a file on the disk with the same name as the Relfilenode node value, in-fact the data inserted for the table is actually stored in the same file.\npostgres=# create table t2(i int); CREATE TABLE postgres=# select oid,relname,relfilenode from pg_class where relname = ’t2’; oid | relname | relfilenode ——-—————––— 16808 | t2 | 16808 (1 row)\npostgres=# \\q movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16808 -rw––—+ 1 movead movead 0 12月 31 17:11 ../data/base/12835/16808 movead@movead-PC:/h2/pgpgpg/bin$\nAfter we perform operations such as truncate, vacuum full, etc. on a table, the data in this table will be rewritten and the value of relfilenode for this table will be changed. The following test shows that after truncate, the relfilenode of the t2 table has changed from 16808 to 16811.\npostgres=# truncate t2; TRUNCATE TABLE postgres=# select oid,relname,relfilenode from pg_class where relname = ’t2’; oid | relname | relfilenode ——-—————––— 16808 | t2 | 16811 (1 row)\npostgres=# checkpoint; CHECKPOINT postgres=# \\q movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16808 ls: 无法访问’../data/base/12835/16808’: 没有那个文件或目录 movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16811 -rw––—+ 1 movead movead 0 12月 31 17:16 ../data/base/12835/16811 movead@movead-PC:/h2/pgpgpg/bin$\n2 Relfilenode of Nail tables postgres=# select oid, relname, relfilenode,reltablespace from pg_class where relfilenode = 0 and relkind = ‘r’ order by reltablespace; oid | relname | relfilenode | reltablespace —————————–——––—+———-–— 1247 | pg_type | 0 | 0 1255 | pg_proc | 0 | 0 1249 | pg_attribute | 0 | 0 1259 | pg_class | 0 | 0 3592 | pg_shseclabel | 0 | 1664 1262 | pg_database | 0 | 1664 2964 | pg_db_role_setting | 0 | 1664 1213 | pg_tablespace | 0 | 1664 1261 | pg_auth_members | 0 | 1664 1214 | pg_shdepend | 0 | 1664 2396 | pg_shdescription | 0 | 1664 1260 | pg_authid | 0 | 1664 6000 | pg_replication_origin | 0 | 1664 6100 | pg_subscription | 0 | 1664 (14 rows)\npostgres=#\nIt can be seen from the above query that the relfilenode of these tables queried from the pg_class catalog is 0. Among them, pg_type, pg_proc, pg_attribute, and pg_class are non-shared tables, and they are called Nail tables in the kernel. The remaining tables are shared tables in the pg_global tablespace.\nThe purpose of relfilenode field in the pg_class table is to tell the user about the file name of a given table stored on the disk. For example, when we query the t2 table, the system must get the relfilenode from the pg_class catalog, then find the file on the disk, open it and scan it. But if we want to query the file name of the pg_class table on disk, where should we find its relfilenode? A set of functional interfaces is provided in PostgreSQL to convert oid and relfilenode.\npostgres=# select pg_relation_filenode(1259); pg_relation_filenode\n16475 (1 row)\npostgres=# select pg_filenode_relation(0,16475); pg_filenode_relation\npg_class (1 row)\npostgres=# select pg_filenode_relation(0,16475)::oid; pg_filenode_relation\n1259 (1 row)\npostgres=#\nBy call pg_relation_filenode(), oid can be converted to relfilenode, and with pg_filenode_relation(), relfilenode can be converted to oid.\nSince the corresponding relationship between oid and relfilenode for shared and nail tables are not stored in the pg_class table, how does PostgreSQL save this mapping relationship?\nnail_\n3 Nail table Relfilenode storage mechanism After research, it is found that there are pg_filenode.map files in the data directory, as shown below.\nmovead@movead-PC:/h2/pgpgpg/data/base/12835$ ll pg_filenode.map -rw––—+ 1 movead movead 512 12月 31 15:10 pg_filenode.map movead@movead-PC:/h2/pgpgpg/data/base/12835$\nmovead@movead-PC:/h2/pgpgpg/data/global$ ll pg_filenode.map -rw––—+ 1 movead movead 512 12月 31 15:10 pg_filenode.map movead@movead-PC:/h2/pgpgpg/data/global$\nThe mapping relationship between oid and relfilenode for shared tables is stored in pg_filenode.map file in the global directory, and the mapping relationship between oid and relfilenode for nail tables in the database with OID 12835 is stored in the 12835 directory.\nThe struct of the pg_filenode.map file is look like as blow:\ntypedef struct RelMapping { Oid mapoid; * OID of a catalog * Oid mapfilenode; * its filenode number * } RelMapping;\ntypedef struct RelMapFile { int32 magic; * always RELMAPPER_FILEMAGIC * int32 num_mappings; * number of valid RelMapping entries * RelMapping mappings[MAX_MAPPINGS]; pg_crc32c crc; * CRC of all above * int32 pad; * to make the struct size be 512 exactly * } RelMapFile;\n4 Summary This blog mainly explains the two different manifestations of oid and relfilenode mapping in PostgreSQL. Just remember that using pg_relation_filenode() will always get the correct result, and query from the pg_class system table may get the wrong result.\n* Movead Li\nMovead.Li is kernel development of Highgo Software. Since joining into Highgo Software in 2016, Movead takes the most time on researching the code of Postgres and is good at ‘Write Ahead Log’ and ‘Database Backup And Recovery’. Base on the experience Movead has two open-source software on the Postgres database. One is Walminer which can analyze history wal file to SQL. The other one is pg_lightool which can do a single table or block recovery base on base backup and walfiles or walfiles only.\nHello\nNow he has joined the HighGo community team and hopes to make more contributions to the community in the future.\n","wordCount":"1342","inLanguage":"zh-cn","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://yangyingchao.github.io/posts/the-mapping-of-oid-and-relfilenode-in-pg/"},"publisher":{"@type":"Organization","name":"MyNotes","logo":{"@type":"ImageObject","url":"https://yangyingchao.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yangyingchao.github.io accesskey=h title="MyNotes (Alt + H)">MyNotes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yangyingchao.github.io/ title=Home><span>Home</span></a></li><li><a href=https://yangyingchao.github.io/posts/ title=Archives><span>Archives</span></a></li><li><a href=https://yangyingchao.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://yangyingchao.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://yangyingchao.github.io/contact/ title="Contact me"><span>Contact me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">The mapping of oid and relfilenode in PG</h1><div class=post-meta></div></header><div class=post-content><ul><li>1 <a href=#h:1f7ebd85-1d1f-499e-9871-86c20f4dee99>Relfilenode of ordinary table</a></li><li>2 <a href=#h:26af2114-0247-479c-acda-e29244cda12e>Relfilenode of Nail tables</a></li><li>3 <a href=#h:e436403d-4da6-4ab0-945c-547dc01b1c7d>Nail table Relfilenode storage mechanism</a></li><li>4 <a href=#h:b40df967-b768-4822-96e4-8277122284f4>Summary</a></li></ul><p>本文为摘录，原文为： <a href=https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/>https://www.highgo.ca/2021/01/12/the-mapping-of-oid-and-relfilenode-in-pg/</a></p><p>A table in PostgreSQL has a relfilenode value, which specifies the file name of the table on disk (except foreign table
and partition table). In general, this value can be found in the relfilenode field of the pg_class table, but there are
some specific tables whose query result in the relfilenode field is 0. This blog will explore the kernel processing of
these special tables relfilenode.</p><h2 id=h:1f7ebd85-1d1f-499e-9871-86c20f4dee99>1 Relfilenode of ordinary table<a hidden class=anchor aria-hidden=true href=#h:1f7ebd85-1d1f-499e-9871-86c20f4dee99>#</a></h2><p>When a normal table is created in PostgreSQL, the relfilenode value of the table is stored in pg_class system table. As
it can be seen in this example that when a table is created, it’s OID and relfilenode value are both 16808. You can also
find a file on the disk with the same name as the Relfilenode node value, in-fact the data inserted for the table is
actually stored in the same file.</p><p>postgres=# create table t2(i int);
CREATE TABLE
postgres=# select oid,relname,relfilenode from pg_class where relname = &rsquo;t2&rsquo;;
oid | relname | relfilenode
&mdash;&mdash;-<del>&mdash;&mdash;&mdash;</del>&mdash;&mdash;&ndash;–—
16808 | t2 | 16808
(1 row)</p><p>postgres=# \q
movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16808
-rw&ndash;–—+ 1 movead movead 0 12月 31 17:11 ../data/base/12835/16808
movead@movead-PC:/h2/pgpgpg/bin$</p><p>After we perform operations such as truncate, vacuum full, etc. on a table, the data in this table will be rewritten and
the value of relfilenode for this table will be changed. The following test shows that after truncate, the relfilenode
of the t2 table has changed from 16808 to 16811.</p><p>postgres=# truncate t2;
TRUNCATE TABLE
postgres=# select oid,relname,relfilenode from pg_class where relname = &rsquo;t2&rsquo;;
oid | relname | relfilenode
&mdash;&mdash;-<del>&mdash;&mdash;&mdash;</del>&mdash;&mdash;&ndash;–—
16808 | t2 | 16811
(1 row)</p><p>postgres=# checkpoint;
CHECKPOINT
postgres=# \q
movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16808
ls: 无法访问&rsquo;../data/base/12835/16808&rsquo;: 没有那个文件或目录
movead@movead-PC:/h2/pgpgpg/bin$ ll ../data/base/12835/16811
-rw&ndash;–—+ 1 movead movead 0 12月 31 17:16 ../data/base/12835/16811
movead@movead-PC:/h2/pgpgpg/bin$</p><h2 id=h:26af2114-0247-479c-acda-e29244cda12e>2 Relfilenode of Nail tables<a hidden class=anchor aria-hidden=true href=#h:26af2114-0247-479c-acda-e29244cda12e>#</a></h2><p>postgres=# select oid, relname, relfilenode,reltablespace
from pg_class
where relfilenode = 0 and relkind = &lsquo;r&rsquo;
order by reltablespace;
oid | relname | relfilenode | reltablespace
&mdash;&mdash;<del>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</del>&mdash;&mdash;&ndash;–—+&mdash;&mdash;&mdash;-–—
1247 | pg_type | 0 | 0
1255 | pg_proc | 0 | 0
1249 | pg_attribute | 0 | 0
1259 | pg_class | 0 | 0
3592 | pg_shseclabel | 0 | 1664
1262 | pg_database | 0 | 1664
2964 | pg_db_role_setting | 0 | 1664
1213 | pg_tablespace | 0 | 1664
1261 | pg_auth_members | 0 | 1664
1214 | pg_shdepend | 0 | 1664
2396 | pg_shdescription | 0 | 1664
1260 | pg_authid | 0 | 1664
6000 | pg_replication_origin | 0 | 1664
6100 | pg_subscription | 0 | 1664
(14 rows)</p><p>postgres=#</p><p>It can be seen from the above query that the relfilenode of these tables queried from the pg_class catalog is 0. Among
them, pg_type, pg_proc, pg_attribute, and pg_class are non-shared tables, and they are called Nail tables in the kernel.
The remaining tables are shared tables in the pg_global tablespace.</p><p>The purpose of relfilenode field in the pg_class table is to tell the user about the file name of a given table stored
on the disk. For example, when we query the t2 table, the system must get the relfilenode from the pg_class catalog,
then find the file on the disk, open it and scan it. But if we want to query the file name of the pg_class table on
disk, where should we find its relfilenode? A set of functional interfaces is provided in PostgreSQL to convert oid and
relfilenode.</p><p>postgres=# select pg_relation_filenode(1259);
pg_relation_filenode</p><hr><pre><code>            16475
</code></pre><p>(1 row)</p><p>postgres=# select pg_filenode_relation(0,16475);
pg_filenode_relation</p><hr><p>pg_class
(1 row)</p><p>postgres=# select pg_filenode_relation(0,16475)::oid;
pg_filenode_relation</p><hr><pre><code>             1259
</code></pre><p>(1 row)</p><p>postgres=#</p><p>By call pg_relation_filenode(), oid can be converted to relfilenode, and with pg_filenode_relation(), relfilenode can be
converted to oid.</p><p>Since the corresponding relationship between oid and relfilenode for shared and nail tables are not stored in the
pg_class table, how does PostgreSQL save this mapping relationship?</p><p>nail_</p><h2 id=h:e436403d-4da6-4ab0-945c-547dc01b1c7d>3 Nail table Relfilenode storage mechanism<a hidden class=anchor aria-hidden=true href=#h:e436403d-4da6-4ab0-945c-547dc01b1c7d>#</a></h2><p>After research, it is found that there are pg_filenode.map files in the data directory, as shown below.</p><p>movead@movead-PC:/h2/pgpgpg/data/base/12835$ ll pg_filenode.map
-rw&ndash;–—+ 1 movead movead 512 12月 31 15:10 pg_filenode.map
movead@movead-PC:/h2/pgpgpg/data/base/12835$</p><p>movead@movead-PC:/h2/pgpgpg/data/global$ ll pg_filenode.map
-rw&ndash;–—+ 1 movead movead 512 12月 31 15:10 pg_filenode.map
movead@movead-PC:/h2/pgpgpg/data/global$</p><p>The mapping relationship between oid and relfilenode for shared tables is stored in pg_filenode.map file in the global
directory, and the mapping relationship between oid and relfilenode for nail tables in the database with OID 12835 is
stored in the 12835 directory.</p><p>The struct of the pg_filenode.map file is look like as blow:</p><p>typedef struct RelMapping
{
Oid mapoid; <em>* OID of a catalog *</em>
Oid mapfilenode; <em>* its filenode number *</em>
} RelMapping;</p><p>typedef struct RelMapFile
{
int32 magic; <em>* always RELMAPPER_FILEMAGIC *</em>
int32 num_mappings; <em>* number of valid RelMapping entries *</em>
RelMapping mappings[MAX_MAPPINGS];
pg_crc32c crc; <em>* CRC of all above *</em>
int32 pad; <em>* to make the struct size be 512 exactly *</em>
} RelMapFile;</p><h2 id=h:b40df967-b768-4822-96e4-8277122284f4>4 Summary<a hidden class=anchor aria-hidden=true href=#h:b40df967-b768-4822-96e4-8277122284f4>#</a></h2><p>This blog mainly explains the two different manifestations of oid and relfilenode mapping in PostgreSQL. Just remember
that using pg_relation_filenode() will always get the correct result, and query from the pg_class system table may get
the wrong result.</p><p>*
Movead Li</p><p>Movead.Li is kernel development of Highgo Software. Since joining into Highgo Software in 2016, Movead takes the most
time on researching the code of Postgres and is good at ‘Write Ahead Log’ and ‘Database Backup And Recovery’. Base on
the experience Movead has two open-source software on the Postgres database. One is Walminer which can analyze history
wal file to SQL. The other one is pg_lightool which can do a single table or block recovery base on base backup and
walfiles or walfiles only.</p><p>Hello</p><p>Now he has joined the HighGo community team and hopes to make more contributions to the community in the future.</p></div><footer class=post-footer><ul class=post-tags></ul></footer><script src=https://giscus.app/client.js data-repo=yangyingchao/giscus data-repo-id=R_kgDON6NYZA data-category=Announcements data-category-id=DIC_kwDON6NYZM4CnANs data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://yangyingchao.github.io>MyNotes</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>